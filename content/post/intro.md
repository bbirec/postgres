+++
date = "2016-01-07T13:45:44+09:00"
draft = true
title = "PostgreSQL 소개"

+++

## 이 글을 시작하면서..

현재 스테이션3 에서 운영하는 다방(http://www.dabangapp.com/) 의 DB는 Postgres를 사용하고 있다. 트래픽이 늘고 시스템이 복잡해짐에 따라 원활한 서비스를 제공하기 위해서 Postgres를 조금 더 제대로 알아야 한다는 필요성을 느꼈다.
하지만, Postgres에 대한 한글로 된 문서나 경험담을 찾기 힘들었고, 이번 기회에 우리가 겪은 경험담과 공부하면서 
알게된 것들을 정리해 보려고 한다.

## Postgres 소개
Mysql처럼 관계형 데이터베이스(RDBMS) 이며, 정확하게는 객체-관계형 데이터베이스(ORDBMS)이다. 보통 사용하는 SQL Standard를
따르고 있어 일반적인 SQL문을 사용해서 쿼리를 한다. 1995년 부터 오픈소스로 개발되어 왔고 Mysql을 포함하여 가장 유명한
오픈소스 데이터베이스 중 하나이다. Instagram, Skype, Apple등 유명한 회사의 실서비스에 사용 할 정도로 안정적이며
속도도 빠른것으로 소문이 나 있다.

## 왜 Postgres를 쓰는가
서비스를 만들때 어떤 데이터베이스를 사용할지 결정하는 것은 어떤 언어를 써서 개발을 하는 것 만큼 요구사항에 가장 적합한 것을
골라서 사용해야 한다. MongoDB, CouchDB와 같은 NoSQL이 최근 큰 유행을 했지만, RDBMS를 사용하기로 결정한 뒤에도 
다양한 데이터베이스 중 어떤 것을 골라야 할지는 고민스러울 수 밖에 없다.

Postgres가 Mysql 비해 모든 측면에서 월등히 좋다고 말할수는 없다. 대신 Postgres가 다른 데이터베이스에
비해서 좋은점이 충분히 많이 있다고 할 수 있다. 예를 들어 Mysql은 너무 유명해서 많은 사용기와 같은 리스소가 있는 반면,
데이터가 많이 있는 테이블에 컬럼을 추가하거나 인덱스를 추가하는 경우 테이블에 Lock이 걸리고 오랜 시간이 걸린다. 
이런 부분에 있어서는 Mysql에 비해 간단히 되기 때문에 Production레벨의 서비스에서 운영 및 관리가 편하다고 할 수 있다.
하지만 Postres에서는 테이블의 Row 개수를 구하는 쿼리를 하는 경우 항상 처음부터 끝까지 다 세어보기 때문에 
간단하게 구현할 수 없고, 캐쉬를 한다던지의 다른 방법을 강구해야만 한다.

스테이션3에서 Postgres를 선택했던 가장 큰 이유 중 하나는 PostGIS Extension이다. 다방 서비스는 
위치기반 서비스 이며 다양한 Geospatial 쿼리 함수가 필요했다. PostGIS Extension은 매우 강력하고, 다양한 위치기반 관련된
함수들을 제공하며, 빠르게 동작한다. 이런것 처럼 Postgres는 유명한 Extension이 잘 되어 있어서, Full-text search와 
같은 기능을 쉽게 추가 가능하다.


## Postgres 시작하기
가장 쉽게 시작하는 방법은 로컬에 설치하거나, 이미 클라우드 컴퓨팅 업체에서 호스팅 받아서 사용하는 것이다.

### OS X
맥에 Postres를 설치하기 가장 쉬운 방법은 Heroku에서 만든 Postgres.App(http://postgresapp.com/) 을 설치하는 
것이다. 일반적인 Application처럼 다운받아서 실행하기만 하면 Postgres 서버와 관련 tool을 사용할 수 있다. 게다가
자주 쓰는 Extension을 기본 탑재하고 있어서 PostGIS와 같은 Extension을 바로 사용해 볼 수 있는 장점이 있다.

### 클라우드
아래와 같은 클라우드 컴퓨팅 서비스를 제공하는 업체를 통해 무료 또는 유료로 호스팅 받아서 사용할 수 있다. 아무런 설치 과정이나
설정도 없이 바로 `postgres://...`와 같은 주소로 접근가능하다.

 - Heroku Postgres : https://www.heroku.com/postgres
 - AWS RDS : https://aws.amazon.com/rds
 - Compose : https://www.compose.io

## Postgres 사용하기
일단 설치 및 호스팅으로 부터 주소를 받으면 `psql`이라는 Postgres 전용 클라이언트 프로그램으로 쿼리를 실행해 볼 수 있다.
`psql`은 Postgres를 설치하면 함께 설치되는 커맨드라인 프로그램이다.

아래와 같이 `psql`을 실행하면 쿼리를 입력할 수 있는 입력창이 생긴다. 여기에 `SELECT`문과 같은 쿼리를 입력하면 그 결과가 출력된다.
```
$ psql 
psql (9.4.4)
Type "help" for help.

bbirec=#
```

## 마치면서
다방을 만들면서 Postgres를 선택했던 이유는 단순히 PostGIS 때문이었지만, 사용하면서 관련 리소스를 찾다보니 
해외에서는 Mysql 보다 좋다는 평을 받고 있다는 것을 알게 되었다. 또한 어느정도 규모 있는 서비스에서 안정적인 서비스를 제공하기 위해서는
데이터베이스 관리가 가장 중요하다는 것을 최근 깨닫게 되었다. 이번 계기로 우리 스스로도 공부가 많이 되고, Postgres를 사용하고 있거나
사용 예정인 사람들에게 유용한 정보를 공유할 수 있는 기회가 되었으면 한다.




